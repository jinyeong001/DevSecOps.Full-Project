# YAML 작성법

## yaml 이란?
---

YAML은 "YAML Ain't Markup Language"의 약자로, 데이터 직렬화에 사용되는 가볍고 사람이 읽기 쉬운 형식입니다.
JSON이나 XML과 비교해 간결하고 이해하기 쉬운 구문을 제공하며, 설정 파일이나 데이터 저장에 자주 활용됩니다.
YAML은 들여쓰기를 통해 데이터 구조를 정의하며, 주로 다음과 같은 특징이 있습니다.
- **간결성**: 태그나 괄호 없이 간단한 텍스트 기반 형식.
- **유연성**: 다양한 데이터 타입과 구조를 지원.
- **사람이 읽기 쉬움**: 들여쓰기로 계층 구조를 표현.
<br><br><br>

## yaml 파일 주요 필드
---

이 작성법은 DevSecOps 환경에서 사용되는 주요 필드(apiVersion, kind, metadata, spec)와
Kubernetes 워커 노드를 추가하는 방법을 중심으로 작성되었습니다. <br>

###### **1) apiVersion**
- 뜻: PI 버전을 지정합니다. Kubernetes 리소스 종류마다 지원하는 API 버전이 다를 수 있습니다.
- 사용 목적: Kubernetes가 리소스를 처리할 때 올바른 API를 호출하도록 지시합니다.
- <a href="#" class="show-code" data-code-file="apiVersion">apiVersion 예시</a>

###### **2) kind**
- 뜻: YAML 파일이 정의하는 리소스의 유형을 지정합니다.
- 사용 목적: Kubernetes에서 정의된 리소스 종류(Deployment, Pod 등)를 나타냅니다.
- <a href="#" class="show-code" data-code-file="kind">kind 예시</a>

###### **3) metadata**
- 뜻: 리소스의 고유 식별자와 기타 메타데이터를 지정합니다. 리소스 이름, 라벨, 주석 등을 포함합니다.
- 사용 목적: 리소스를 식별하거나 관리할 때 사용되는 정보를 제공합니다.
- <a href="#" class="show-code" data-code-file="metadata">metadata 예시</a>

###### **4) spec**
- 뜻: 리소스의 동작 방식과 구성 세부 사항을 정의합니다.
- 사용 목적: Pod 탬플릿, 컨테이너 정의, 서비스 포트 등을 지정합니다.
- <a href="#" class="show-code" data-code-file="spec">spec 예시</a>
<br><br><br>

## 워커 노드 추가
---

###### **1) kind-config.yaml 파일**
워커 노드 설정은 nodes 필드에 추가합니다.
```yaml
kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
nodes:
- role: control-plane
- role: worker
    labels:
        node-type: webserver
        purpose: apache-php
- role: worker
    labels:
        node-type: database
        purpose: mysql
```
*role:worker: 워커 노드로 역할을 지정*
*labels: 각 워커 노드에 태그를 추가하여 특정 워크노드에 연결*
<br>

###### **2) Deployment에서 워커 노드 참조** 
특정 노드에서 실행되도록 nodeSelector를 사용합니다.
```yaml
spec:
  template:
    spec:
      nodeSelector:
        node-type: webserver
```
*nodeSelector: 특정 노드에서 실행되도록 지정*
*node-type: 노드 유형을 지정*
<br>

###### **3) 노드 상태 확인** 
Windows PowerShell 실행 후, 명령어를 통해 클러스트 상태 확인.
```
kubectl get nodes --show-labels
```
<br><br><br>

## yaml 파일 기타 필드
---


###### **1) status**
- 뜻: 리소스의 현재 상태를 나타냅니다.
- 사용 목적: 리소스가 배포된 후 Kubernetes가 관리하는 동적인 상태 정보를 기록합니다. 사용자가 수동으로 설정할 필요는 없습니다.
- <a href="#" class="show-code" data-code-file="status">status 예시</a>

###### **2) selector**
- 뜻: 리소스를 특정 레이블을 기준으로 연결합니다.
- 사용 목적: Deployment와 같은 리소스가 Pod를 선택하거나 Service가 대상 Pod를 식별할 때 사용됩니다.
- <a href="#" class="show-code" data-code-file="selector">selector 예시</a>

###### **3) template**
- 뜻: 리소스가 생성할 객체(Pod 등)의 템플릿을 정의합니다.
- 사용 목적: Deployment, DaemonSet 등의 리소스에서 사용되며, 생성할 Pod의 세부 설정을 포함합니다.
- <a href="#" class="show-code" data-code-file="template">template 예시</a>

###### **4) volumes**
- 뜻: 컨테이너에서 사용할 볼륨을 정의합니다.
- 사용 목적: 데이터의 영속성을 보장하거나 컨테이너 간 데이터를 공유할 때 사용됩니다.
- <a href="#" class="show-code" data-code-file="volumes">volumes 예시</a>

###### **5) resources**
- 뜻: 컨테이너에서 사용할 CPU와 메모리 리소스를 제한하거나 요청합니다.
- 사용 목적: 클러스터의 리소스를 효율적으로 관리합니다.
- <a href="#" class="show-code" data-code-file="resources">resources 예시</a>

###### **6) env**
- 뜻: 컨테이너 내에서 사용할 환경 변수를 정의합니다.
- 사용 목적: 동적인 환경 설정을 제공하거나 비밀 값을 주입합니다.
- <a href="#" class="show-code" data-code-file="env">env 예시</a>

###### **7) ports**
- 뜻: 컨테이너가 노출하는 네트워크 포트를 정의합니다.
- 사용 목적: 외부 네트워크와의 통신 경로를 설정합니다.
- <a href="#" class="show-code" data-code-file="ports">ports 예시</a>

###### **8) nodeSelector**
- 뜻: 특정 노드에서 리소스를 실행하도록 지정합니다.
- 사용 목적: 지정된 레이블을 기준으로 Pod가 실행될 노드를 선택합니다.
- <a href="#" class="show-code" data-code-file="nodeSelector">nodeSelector 예시</a>

###### **9) affinity**
- 뜻: Pod 배치 전략을 정의합니다.
- 사용 목적: 특정 노드에 Pod을 배치하거나, 특정 노드에서 실행되지 않도록 제약 조건을 설정합니다.
- <a href="#" class="show-code" data-code-file="affinity">affinity 예시</a>